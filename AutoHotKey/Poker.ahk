;=====================================================================o
;                       CapsLock Initializer                         ;|
;---------------------------------------------------------------------o
#Persistent                                                          ;|
#SingleInstance, Force                                               ;|
SetKeyDelay, -1                                                      ;|
SetCapsLockState, AlwaysOff                                          ;| 
#HotkeyInterval 2000                                                 ;|
#MaxHotkeysPerInterval 200                                           ;|
#If GetKeyState("CapsLock", "p")                                     ;|
;---------------------------------------------------------------------o

;=====================================================================o
;                    CapsLock Direction Navigator                    ;|
;-----------------------------------o---------------------------------o
;                      CapsLock + h |  Left                          ;|
;                      CapsLock + j |  Down                          ;|
;                      CapsLock + k |  Up                            ;|
;                      CapsLock + l |  Right                         ;|
;-----------------------------------o---------------------------------o
;                      Ctrl, Alt Compatible                          ;|
;-----------------------------------o---------------------------------o
h::left                                                              ;|
j::down                                                              ;|
k::up                                                                ;|
l::right                                                             ;|
;=====================================================================o
;                           CapsLock Deletor                         ;|
;-----------------------------------o---------------------------------o
;                     CapsLock + n  |  Ctrl + Delete                 ;|
;                     CapsLock + m  |  Delete                        ;|
;-----------------------------------o---------------------------------o
m::Del                                                               ;|
n::BS                                                                ;|
;---------------------------------------------------------------------o

;=====================================================================o
;                     CapsLock Home/End Navigator                    ;|
;-----------------------------------o---------------------------------o
;                      CapsLock + ; |  Home                          ;|
;                      CapsLock + . |  End                           ;|
;---------------------------------------------------------------------o
;                      Ctrl, Alt Compatible                          ;|
;---------------------------------------------------------------------o
;i::Home                                                              ;|
;o::End                                                               ;|
;---------------------------------------------------------------------o

;=====================================================================o
;                      CapsLock Page Navigator                       ;|
;-----------------------------------o---------------------------------o
;                      CapsLock + ' |  PageUp                        ;|
;                      CapsLock + / |  PageDown                      ;|
;---------------------------------------------------------------------o
;u:: PgUp                                                             ;|
;p:: PgDn                                                             ;|
;---------------------------------------------------------------------o

;=====================================================================o
;                       CapsLock Number Initializer                  ;|
;---------------------------------------------------------------------o
1:: F1                                                               ;|
2:: F2                                                               ;|
3:: F3                                                               ;|
4:: F4                                                               ;|
5:: F5                                                               ;|
6:: F6                                                               ;|
7:: F7                                                               ;|
8:: F8                                                               ;|
9:: F9                                                               ;|
0:: F10                                                              ;|
-:: F11                                                              ;|
=:: F12                                                              ;|
;---------------------------------------------------------------------o

;=====================================================================o
;                       CapsLock A-Z Initializer                     ;|
;---------------------------------------------------------------------o
a:: HOME                                                             ;|
b:: ^b                                                               ;|
c:: ^c                                                               ;|
d:: PgDn                                                             ;|
e:: END                                                              ;|
f:: ^f                                                               ;|
g:: ^g                                                               ;|
i:: F2                                                               ;|
o:: ^o                                                               ;|
p:: ^v                                                               ;|
q:: ^q                                                               ;|
r:: ^r                                                               ;|
s:: ^s                                                               ;|
t:: ^t                                                               ;|
u:: PgUp                                                             ;|
v:: ^v                                                               ;|
w:: ^w                                                               ;|
x:: ^x                                                               ;|
y:: ^c                                                               ;|
z:: ^z                                                               ;|
;---------------------------------------------------------------------o

;=====================================================================o
;                                 Tools                              ;|
;-----------------------------------o---------------------------------o
;                                                                    ;|
;---------------------------------------------------------------------o
[:: Esc                                                              ;|
;---------------------------------------------------------------------o
/:: ^f                                                               ;|
;---------------------------------------------------------------------o
sc027:: AppsKey                                                      ;|
;---------------------------------------------------------------------o
esc:: `                                                              ;|
;---------------------------------------------------------------------o
rshift:: `                                                           ;|
;---------------------------------------------------------------------o

;=====================================================================o
;                                Over IF                             ;|
;-----------------------------------o---------------------------------o
#if                                                                  ;|
;---------------------------------------------------------------------o

;=====================================================================o
;                             Esc Cover ~                            ;|
;-----------------------------------o---------------------------------o
+esc:: ~                                                             ;|
return                                                               ;|
;-----------------------------------o---------------------------------o

;=====================================================================o
;                       The current path Open bash                   ;|
;-----------------------------------o---------------------------------o
;                            Ctrl + Shift + P                        ;|
;---------------------------------------------------------------------o
!Enter::                                                             ;|
;---------------------------------------------------------------------o
If WinActive("ahk_class CabinetWClass")                              ;|  
|| WinActive("ahk_class ExploreWClass")                              ;| 
|| WinActive("ahk_class WorkerW")                                    ;| 
{                                                                    ;|
WinHWND := WinActive()                                               ;|
For win in ComObjCreate("Shell.Application").Windows                 ;|
If (win.HWND = WinHWND)                                              ;|
{                                                                    ;|
dir := SubStr(win.LocationURL, 9)                                    ;|
dir := RegExReplace(dir, "%20", " ")                                 ;|
Break                                                                ;|
}                                                                    ;| 
Run wt, % dir ? dir: A_Desktop                                       ;|
}                                                                    ;|
else{                                                                ;|
Run wt -d .                                                          ;|
}                                                                    ;|
return                                                               ;|
;---------------------------------------------------------------------o

;=====================================================================o
;                       Create Word Excel Notepad                    ;|
;-----------------------------------o---------------------------------o
;^+o::                                                               ;|
;Run notepad.exe,,UseErrorLevel                                      ;|
;return                                                              ;|
;-----------------------------------o---------------------------------o
;^+w::                                                               ;| 
 ;Run winword.exe,,UseErrorLevel                                     ;|
;return                                                              ;|
;-----------------------------------o---------------------------------o
;^+e::                                                               ;|
;Run excel.exe,,UseErrorLevel                                        ;|
;return                                                              ;|
;-----------------------------------o---------------------------------o
sc027 & e::                                                          ;| 
Send #{2}                                                            ;|
return                                                               ;|
;---------------------------------------------------------------------o
;
;=====================================================================o
;                            Total Commandes                         ;|
;-----------------------------------o---------------------------------o
#IfWinActive ahk_exe TOTALCMD64.EXE ahk_class TTOTAL_CMD             ;|
IsLastKey(key)                                                       ;|
{                                                                    ;|
return (A_PriorHotkey == key and A_TimeSincePriorHotkey < 400)       ;|
}                                                                    ;|
;-----------------------------------o---------------------------------o
h::                                                                  ;|  
ControlGetFocus, ctrl                                                ;|  
if (ctrl == "LCLListBox2" ) || (ctrl == "LCLListBox1" )              ;|
Send, {Backspace}                                                    ;|   
else                                                                 ;|
Send, h                                                              ;|
return                                                               ;|
;-----------------------------------o---------------------------------o
j::                                                                  ;|  
ControlGetFocus, ctrl                                                ;|  
if (ctrl == "LCLListBox2" ) || (ctrl == "LCLListBox1" )              ;|  
Send, {Down}                                                         ;|
else                                                                 ;|  
Send, j                                                              ;|  
return                                                               ;|  
;-----------------------------------o---------------------------------o
k::                                                                  ;|  
ControlGetFocus, ctrl                                                ;|  
if (ctrl == "LCLListBox2" ) || (ctrl == "LCLListBox1" )              ;|  
Send, {Up}                                                           ;|
else                                                                 ;|  
Send, k                                                              ;|  
return                                                               ;|  
;-----------------------------------o---------------------------------o
l::                                                                  ;|  
ControlGetFocus, ctrl                                                ;|  
if (ctrl == "LCLListBox2" ) || (ctrl == "LCLListBox1" )              ;|  
Send, {Enter}                                                        ;|
else                                                                 ;|  
Send, l                                                              ;|  
return                                                               ;|  
;-----------------------------------o---------------------------------o
g::                                                                  ;|
ControlGetFocus, ctrl                                                ;|  
if IsLastKey("g") && (ctrl == "LCLListBox2" )                        ;|   
|| (ctrl == "LCLListBox1" )                                          ;|   
{                                                                    ;|
Send, {Home}                                                         ;|
}                                                                    ;|
else                                                                 ;|  
Send, g                                                              ;|  
return                                                               ;|
;-----------------------------------o---------------------------------o
+g::                                                                 ;|
ControlGetFocus, ctrl                                                ;|  
if (ctrl == "LCLListBox2" ) || (ctrl == "LCLListBox1" )              ;|  
Send, {END}                                                          ;|
else                                                                 ;|  
Send, G                                                              ;|  
return                                                               ;|
;-----------------------------------o---------------------------------o
i::                                                                  ;|
ControlGetFocus, ctrl                                                ;|  
if (ctrl == "LCLListBox2" ) || (ctrl == "LCLListBox1" )              ;|  
send +{F6}                                                           ;|
else                                                                 ;|  
Send, i                                                              ;|  
return                                                               ;|
;-----------------------------------o---------------------------------o
d::                                                                  ;|
ControlGetFocus, ctrl                                                ;|  
if IsLastKey("d") && (ctrl == "LCLListBox2" )                        ;|   
|| (ctrl == "LCLListBox1" )                                          ;|   
{                                                                    ;|
Send, {F8}                                                           ;|
}                                                                    ;|
else                                                                 ;|  
Send, F8                                                             ;|  
return                                                               ;|
;-----------------------------------o---------------------------------o
c::                                                                  ;|
ControlGetFocus, ctrl                                                ;|  
if IsLastKey("c") && (ctrl == "LCLListBox2" )                        ;|   
|| (ctrl == "LCLListBox1" )                                          ;|   
{                                                                    ;|
Send, !{g}                                                           ;|
Send,{Tab}{Tab}{Tab}{Tab}{Tab}{Tab}{Tab}{Tab}{Tab}{Tab}{Tab}         ;|
}                                                                    ;|
else                                                                 ;|  
Send, c                                                              ;|  
return                                                               ;|
;-----------------------------------o---------------------------------o
sc027:: `;                                                           ;|  
sc027 & q::                                                          ;| 
Send, !{F4}                                                          ;|  
sc027 & f::                                                          ;| 
Send, !{F7}                                                          ;|  
sc027 & e::                                                          ;| 
Send, ^{d}{Down}{Enter}                                              ;|  
return                                                               ;|  
;-----------------------------------o---------------------------------o
#IfWinActive                                                         ;|
;---------------------------------------------------------------------o